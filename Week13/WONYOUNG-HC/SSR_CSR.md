# CSR

### 교육 목표

- SSR과 CSR의 개념과 동작 방식
- SEO의 개념

### 목차

1. MPA와 SPA
2. CSR
3. SSR
4. SEO
5. SPA기반 SSR

## MPA와 SPA

### MPA (Multiple Page Application)

- 여러 개(Multiple)의 Page로 구성된 Application
  페이지마다 html파일이 존재
- **새로운 페이지를 요청할 때 마다** 정적 리소스를 다운받은 후 전체 페이지를 다시 렌더링
- jsp, php같은 웹 서버 언어로 페이지 구축시 사용
- 장점 : **최초 페이지 렌더링**이 빠름
- 단점 : 새로운 페이지 이동시 **화면이 깜빡이는(blinking) 순간**이 존재
  - 페이지 렌더링 되는 시간

<br>

### SPA (Single Page Application)

- 한 개(Single)의 Page로 구성된 Application
- 모든 정적 리소스를 **최초 한번에 다운로드**
- 새로운 페이지 요청이 있을 시 **필요한 데이터만** 서버로부터 전달 받음
- Angular, React, Vue, Next, Nuxt
- 장점 : **페이지 전환**이 빠름
- 단점 : **최초 페이지 렌더링이 느림**

<br>

## CSR (Client Side Rendering)

### CSR 개념

- 서버가 클라이언트에게 HTML과 자바스크립트 파일을 보내주고, **클라이언트인 브라우저가 해당 파일들을 렌더링**하는 방식
- 모든 로직을 서버가 아닌 **클라이언트가 처리**하는 방식
- 렌더링이 완전히 실행되기 이전에는 화면에 **아무 정보가 표시되지 않음**
- Angluar, React, Vue

<br>

### CSR 동작 방식

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FEk28V%2FbtrFde42IHr%2Fyb4wyWVcsqkV96kkrpS4Z0%2Fimg.png">

1. 유저가 웹사이트에 방문
2. 서버가 자바스크립트코드 링크를 가지고 있는 HTML 파일을 제공
3. 브라우저는 HTML과 자바스크립트 파일을 다운로드. 아직 화면에는 아무 정보가 표시되지 않음
4. 브라우저가 자바스크립트 파일을 다운로드. (3은 HTML파일에서 자바스크립트 경로를 확인하는거고, 여기서 자바스크립트코드를 다운받는다고 해석)
5. 자바스크립트가 실행되고 api를 통해 정보들을 가져옴. 이제 placeholder를 화면에 보여줌
6. 서버가 api 응답
7. 서버로부터 응답받은 데이터를 placeholder에 채우고, 페이지가 렌더링이 완료되어 조작이 가능해짐

<br>

### CSR의 장단점

장점

- **페이지 전환이 빨라** 사용자 경험(UX)가 좋음
- **서버 자원 활용이 적음**

단점

- **첫 페이지를 로딩하기에 시간이 걸림**

## SSR (Server Side Rendering)

### SSR의 개념

- **서버에서 HTML을 미리 준비**해서 클라이언트한테 응답해주는 방식
- 서버에서 사용자에게 보여줄 페이지를 모두 구성하여 사용자에게 페이지를 보여주는 방식
- 렌더링 완료된 페이지가 전달되어 클라이언트가 **서버로부터 응답을 받고 곧바로 화면에 페이지를 보여줌**
- Next, Nuxt

### SSR 동작 방식

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbhTWQ6%2Fbtr1HhAQnXx%2F9MagapCGjxX8sHRZ0wk3rK%2Fimg.png">

1. 유저가 웹사이트에 방문
2. 서버는 유저가 보기를 원하는 페이지의 **HTML을 렌더링하여 제공**
3. 브라우저는 서버에서 렌더링이 완료된 HTML파일을 보여줌. 하지만 자바스크립트 코드는 실행되지 않았기 때문에 **사이트 조작 불가**(클릭과 같은 이벤트)
4. 브라우저는 해당 페이지의 자바스크립트코드를 다운로드 (자바스크립트 코드는 HTML 파일에 명시)
5. 자바스크립트를 실행하면서 콘텐츠들(동적으로 화면에 보이는것들)이 화면에 표시. 아직 자바스크립트가 완전히 실행되지 않았기 때문에 **페이지 조작은 불가능**하나, 유저가 발생시키는 이벤트들은 기록해둠
6. 자바스크립트 실행
7. 페이지 렌더링이 완료되고, 5번 단계에서 기록된 이벤트들을 실행시킴

<br>

### SSR 장단점

장점

- **첫 페이지를 로딩**하는 시간이 빠름

단점

- **페이지 전환이 느림**
- **많은 서버 자원 사용**

<br>

## SEO (Search Engine Oprimization)

### SEO 개념

- 검색 엔진 최적화
- 검색엔진이 자료를 수집하고 순위를 매기는 방식에 맞게 웹 페이지를 구성하여 **검색 결과의 상위**에 나올 수 있도록 하는 작업
- **웹 크롤러와 같은 봇**이 웹사이트의 HTML태그, 본문 내용, 이미지 등을 수집하여 웹 사이트의 정보 콘텐츠를 구조화하고, 이를 사용자가 키워드로 검색으로 하였을 때, 사용자가 입력한 키워드에 부합되는 정보를 순서대로 보여줌

### CSR에서 SEO

- CSR에서는 SSR보다 **SEO에 취약함**
- 페이지 최초 접속시 서버에서 제공하는 HTML은 **빈 파일**임 (웹 크롤러가 볼게 없음)

```html
<!-- React 사용시 서버에서 제공하는 HTML -->
<body>
  <div id="app"></div>
</body>
```

- 구글의 크롤러는 자바스크립트까지 실행하여 페이지 정보를 수집하지만, 이는 **기존 SSR 방식의 페이지보단 SEO 효율이 좋지 않음**
- 네이버에서도 CSR을 위한 SEO를 지원하지만, 더 많은 컴퓨팅 파워가 필요해 **SSR 방식을 권장**
- CSR을 위한 크롤러를 개발하지 않은 검색엔진에서는 **SEO가 불가능**

<br>

### SSR에서 SEO

- SSR은 **서버에서 렌더링이 완료**된 HTML을 전송하기 떄문에 SEO가 CSR보다 우수함

## SPA기반 SSR

SPA, MPA와 CSR, SSR의 내용을 이해했다면 SPA가 곧 CSR이고, MPA가 곧 SSR이라는 생각을 가질 수 있음
<br>
하지만 Next.js나 Nuxt.js는 SPA이지만, SSR 방식을 사용함.
<br>
Next에서 코드를 작성할 때 서버사이드 렌더딩하는 컴포넌트를 개별적으로 작성 (getServerSideProps)
<br>
최초 페이지 접속에서는 서버사이드 렌더링 해둔 페이지를 보여주고, 그 이후로는 CSR 방식으로 렌더링
